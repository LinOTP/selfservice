<mat-horizontal-stepper [linear]="true"
                        linear
                        #stepper>
  <mat-step>
    <p>Activate the token "{{ data.token.serial }}"</p>
    <mat-dialog-actions align="end">
      <div>Activation {{currentStep}} of {{maxSteps}}</div>
      <span class="spacer"></span>
      <button mat-raised-button
              (click)="cancelDialog()">Cancel</button>
      <button mat-raised-button
              color="primary"
              id="goTo2"
              (click)="activateToken(stepper)">Activate Push Token</button>
    </mat-dialog-actions>
  </mat-step>
  <mat-step>
    <ng-container *ngIf="waitingForResponse; then spinningBlock else challengeResponseBlock"></ng-container>

    <ng-template #spinningBlock>
      <section class="response">
        <mat-spinner></mat-spinner>
        <p>Waiting for confirmation via KeyIdentity Authenticator.</p>
      </section>
      <mat-dialog-actions align="end">
        <div>Activation {{currentStep}} of {{maxSteps}}</div>
        <span class="spacer"></span>
        <button mat-raised-button
                (click)="cancelDialog()">Cancel</button>
      </mat-dialog-actions>
    </ng-template>
    <ng-template #challengeResponseBlock>
      <section class="response">
        <h2 *ngIf="restartDialog">Token activation failed</h2>
        <h2 *ngIf="!restartDialog">Activation successful!</h2>
      </section>
      <mat-dialog-actions align="end">
        <div>Activation {{currentStep}} of {{maxSteps}}</div>
        <span class="spacer"></span>
        <button mat-raised-button
                (click)="cancelDialog()"
                *ngIf="restartDialog">Cancel</button>
        <button mat-raised-button
                (click)="resetDialogToInitial(stepper)"
                *ngIf="restartDialog">Restart activation</button>
        <button mat-raised-button
                (click)="cancelDialog()"
                *ngIf="!restartDialog">Finish</button>
      </mat-dialog-actions>
    </ng-template>

  </mat-step>
</mat-horizontal-stepper>